<app-main-layout>
  <div class="create-recipe-container">
  <div class="create-recipe-header">
    <button mat-icon-button class="back-button" (click)="onCancel()" aria-label="Go back">
      <mat-icon>arrow_back</mat-icon>
    </button>
    <p>Edit Recipe</p>
  </div>


  @if (recipe) {
    <form [formGroup]="recipeForm" (ngSubmit)="onSubmit()" class="create-recipe-form">
      <mat-expansion-panel expanded="true" class="image-upload-panel">
          <mat-expansion-panel-header>
            <mat-panel-title>Recipe Photo</mat-panel-title>
          </mat-expansion-panel-header>
          <div class="image-drop-zone" (dragover)="onDragOver($event)" (dragleave)="onDragLeave($event)" (drop)="onDrop($event)">
            @if (imageSrc) {
              <img [src]="imageSrc" alt="Recipe image" class="uploaded-image">
            } @else {
              <div class="placeholder" (click)="triggerFileInput()">
                <mat-icon>cloud_upload</mat-icon>
                <p>Drag and drop an image here or click to browse</p>
              </div>
            }
          </div>
          <input type="file" #fileInput accept="image/*" (change)="onFileSelected($event)" style="display: none;">
          <div class="image-actions">
            <button mat-flat-button color="warn" (click)="removeImage()" [disabled]="!imageSrc">
              <mat-icon>delete</mat-icon>
              Remove
            </button>
          </div>
        </mat-expansion-panel>

        <mat-expansion-panel expanded="true" class="recipe-info-panel">
          <mat-expansion-panel-header>
            <mat-panel-title>Recipe Basic Information</mat-panel-title>
          </mat-expansion-panel-header>

          <mat-form-field appearance="outline">
            <mat-label>Title</mat-label>
            <input matInput formControlName="title" required>
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Description</mat-label>
            <textarea matInput formControlName="description" required></textarea>
          </mat-form-field>

        </mat-expansion-panel>

        <button matFab extended color="primary" type="submit" [disabled]="!recipeForm.valid" class="create-recipe-button">
            <mat-icon>update</mat-icon>
            Update Recipe
        </button>
      </form>
  } @else {
    <p>Recipe not found.</p>
  }
  </div>
</app-main-layout>
